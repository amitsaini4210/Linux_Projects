
############  Hosted multiple websites using Nginx virtual hosting. Configured separate server blocks, document roots, access/error logs, firewall rules, and tested using hosts file and curl.
##########   Implemented self-signed SSL certificates for multiple Nginx virtual hosts in a lab environment. Configured HTTPS (443), HTTP to HTTPS redirection, SSL key management, and tested using hosts file and curl.

********************************************
Website 1 ‚Üí site1.example.com
Website 2 ‚Üí site2.example.com
Web server ‚Üí Nginx
Method ‚Üí Name-based Virtual Hosting

******************************************
1Ô∏è‚É£ Install Nginx
 dnf install nginx -y
 systemctl enable nginx
 systemctl start nginx

‚úÖ Verify:
systemctl status nginx

2Ô∏è‚É£ Create Website Directories
 mkdir -p /var/www/site1
 mkdir -p /var/www/site2


Set permissions:
 chown -R nginx:nginx /var/www/site1 
 chown -R nginx:nginx /var/www/site2

3Ô∏è‚É£ Create Test HTML Files

Site 1:
<h1>Welcome to Nginx Web Server - Site 1</h1>  >>  /var/www/site1/index.html

Site 2:
<h1>Welcome to Nginx Web Server - Site 2</h1>  >>  /var/www/site2/index.html



4Ô∏è‚É£ Create Nginx Server Block Configs
Create config files in:
vim /etc/nginx/conf.d/site1.conf

****************

server {
    listen 80;
    server_name site1.example.com;

    root /var/www/site1;
    index index.html;

    access_log /var/log/nginx/site1.access.log;
    error_log /var/log/nginx/site1.error.log;
}

****************

site2 :
Create config files in:
sudo vi /etc/nginx/conf.d/site2.conf

server {
    listen 80;
    server_name site2.example.com;

    root /var/www/site2;
    index index.html;

    access_log /var/log/nginx/site2.access.log;
    error_log /var/log/nginx/site2.error.log;
}


5Ô∏è‚É£ Test Nginx Configuration

 nginx -t

‚úÖ Output should be:
syntax is ok
test is successful


Reload Nginx:
systemctl reload nginx




6Ô∏è‚É£ Test Websites (Without Real DNS)

Method 1: Using /etc/hosts (Best for testing)
sudo vi /etc/hosts

SERVER_IP  site1.example.com
SERVER_IP  site2.example.com


Method 2: Curl Command Test
curl http://site1.example.com
curl http://site2.example.com


Method 3: Browser Test

Open browser:
http://site1.example.com
http://site2.example.com


7Ô∏è‚É£ Firewall (If Sites Not Opening)

firewall-cmd --permanent --add-service=http
firewall-cmd --permanent --add-service=https
firewall-cmd --reload


############# Enable HTTPS Self-Signed SSL for 2 Nginx Websites (Lab Setup)

1Ô∏è‚É£ Create SSL Directory

sudo mkdir -p /etc/nginx/ssl
cd /etc/nginx/ssl


2Ô∏è‚É£ Generate Self-Signed SSL Certificates

Site 1 Certificate:

openssl req -x509 -nodes -days 365 \
-newkey rsa:2048 \
-keyout site1.key \
-out site1.crt

Common Name (CN):
site1.local

Site 2 Certificate:
sudo openssl req -x509 -nodes -days 365 \
-newkey rsa:2048 \
-keyout site2.key \
-out site2.crt


Common Name (CN):
site2.local

3Ô∏è‚É£ Secure SSL Files

sudo chmod 600 /etc/nginx/ssl/*


4Ô∏è‚É£ Configure Nginx HTTPS Server Blocks
Site 1 (site1.conf):

server {
    listen 443 ssl;
    server_name site1.local;

    ssl_certificate     /etc/nginx/ssl/site1.crt;
    ssl_certificate_key /etc/nginx/ssl/site1.key;

   ssl_protocols TLSv1.2 TLSv1.3;
   ssl_prefer_server_ciphers on;

    root /var/www/site1;
    index index.html;
}

server {
    listen 80;
    server_name site1.local;
    return 301 https://$host$request_uri;
}


Site 2 (site2.conf):

server {
    listen 443 ssl;
    server_name site2.local;

    ssl_certificate     /etc/nginx/ssl/site2.crt;
    ssl_certificate_key /etc/nginx/ssl/site2.key;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;

    root /var/www/site2;
    index index.html;
}

server {
    listen 80;
    server_name site2.local;
    return 301 https://$host$request_uri;
}

5Ô∏è‚É£ Test & Reload Nginx
nginx -t
systemctl reload nginx


6Ô∏è‚É£ Configure /etc/hosts 
vim /etc/hosts

192.168.1.100 site1.local
192.168.1.100 site2.local

7Ô∏è‚É£ Firewall Allow HTTPS
firewall-cmd --permanent --add-service=https
firewall-cmd --reload


8Ô∏è‚É£ Test HTTPS
https://site1.local
https://site2.local


Curl Test:
curl -k https://site1.local
curl -k https://site2.local


üîÅ Redirect HTTP to HTTPS in Nginx  for both website 


Site 1 (site1.conf):

server {
    listen 443 ssl;
    server_name site1.example.com;

    ssl_certificate     /etc/nginx/ssl/site1.crt;
    ssl_certificate_key /etc/nginx/ssl/site1.key;

   ssl_protocols TLSv1.2 TLSv1.3;
   ssl_prefer_server_ciphers on;

    root /var/www/site1;
    index index.html;
}

server {
    listen 80;
    server_name site1.example.com;
    return 301 https://site1.example.com$request_uri;
}


Site 2 (site2.conf):

server {
    listen 443 ssl;
    server_name site2.example.com;

    ssl_certificate     /etc/nginx/ssl/site2.crt;
    ssl_certificate_key /etc/nginx/ssl/site2.key;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;

    root /var/www/site2;
    index index.html;
}

server {
    listen 80;
    server_name site2.example.com;
    return 301 https://site2.example.com$request_uri;
}


Test HTTP ‚Üí HTTPS Redirect
Curl Test

curl -I http://site1.example.com


Expected Output:
HTTP/1.1 301 Moved Permanently
Location: https://site1.example.com/













